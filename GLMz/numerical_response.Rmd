---
title: "Numerical Response"
output: "html_document"
date: "15/10/2025"
---


# Model 1 fit
```{r}
# Carreguem les dades
library(readr)
data <- read_csv("preprocessing/clean-data.csv")
```

```{r}
# Descriptiva previa de la variable a estudiar (Admission_grade)
summary(data$Curricular_units_1st_sem_grade)
hist(data$Curricular_units_1st_sem_grade)
```

```{r}
# Construim un mlgz sobre la variable a estudiar
model <- glm(Curricular_units_1st_sem_grade ~ . - Target, data = data, family = gaussian())
summary(model)
```

```{r}
# Construim el model nul
model_nul <- glm(Curricular_units_1st_sem_grade ~ 1, data = data, family = gaussian)

```

```{r}
# Comparem el nostre model complet amb el model nul
anova(model, model_nul, test = "Chisq")
```

```{r}
# Construim un model reduit, eliminant les variables poc significatives
model2 <- glm(
  Curricular_units_1st_sem_grade ~ 
    Course + 
    Curricular_units_1st_sem_credited + 
    Curricular_units_1st_sem_enrolled + 
    Curricular_units_1st_sem_evaluations + 
    Curricular_units_1st_sem_approved + 
    Curricular_units_2nd_sem_approved + 
    Curricular_units_2nd_sem_grade + 
    Mother_s_occupation + 
    Admission_grade,
  data = data, family = gaussian
)
summary(model2)
```

```{r}
# Comparem el nou model amb el model nul, per veure si hi ha diferÃ¨ncia significativa
anova(model, model2, test = "Chisq")
```

```{r}
# Comparem el nou model amb el model complet
anova(model, model2, test = "Chisq")
```

```{r}
# Afegim variables al model reduit (utilitzem la comanda step)
model_step <- step(model, direction = "both")
```

```{r}
# Comparem el model step amb el model complet
anova(model, model_step, test = "Chisq")
```

# Model validation
```{r}
library(car)
residualPlot(model_step)
```

```{r}
library(car)
residualPlots()(model_step)
```

```{r}
influencePlot(model = model_step)
```

```{r}
vif(model_step)
```

